27) 
select contractor_id from 
    (select *, avg(amount) as avg_amount from details_amount_contractor_project GROUP by project_id)
where amount > avg_amount and detail_id = "Д1"
16)
select sum_amount from 
    (select contractor_id, sum(amount) as sum_amount from
    details_amount_contractor_project group by contractor_id)
where contractor_id = "П1"
24)
select id from contractors where status > 
    (select status from contractors where id = "П1")
9)
select detail_id from details_amount_contractor_project 
where contractor_id in 
    (select id from contractors where city = "Лондон")
22)
select project_id from details_amount_contractor_project 
where contractor_id = "П1"
6)
select contractor_id, detail_id, project_id from 
    details_amount_contractor_project 
    where 
    (select city from contractors where id = contractor_id) in
    (select city from details where id = detail_id) in
    (select city from projects where id = project_id)
10)
select detail_id from 
    details_amount_contractor_project 
    where 
    contractor_id in (select id from contractors where city = "Лондон") and
    project_id in (select id from projects where city = "Лондон")
35)
select first.contractor_id, second.detail_id from details_amount_contractor_project as first, details_amount_contractor_project as second
    except select contractor_id, detail_id from details_amount_contractor_project
15)
select count(project_id) from details_amount_contractor_project where contractor_id ="П1" group by contractor_id 
30)
select detail_id from details_amount_contractor_project
    where project_id in 
    (select id from projects where city = "Лондон")
